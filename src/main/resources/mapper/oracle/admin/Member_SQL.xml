<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="member"> 
	<resultMap id="USERSETTING_MAP" type="HashMap">
		<result property="US_INFO1" column="US_INFO1" jdbcType="CLOB" javaType="java.lang.String"/>
		<result property="US_INFO2" column="US_INFO2" jdbcType="CLOB" javaType="java.lang.String"/>
	</resultMap>
  
	 <!-- 로그인 사용자 정보 -->
    <select id="UI_IdCheck" parameterType="String" resultType="USER">
        SELECT *
        FROM   U_USERINFO    	
    	WHERE  UI_ID = #{UI_ID}
    </select>	
    
    <select id="UI_getData" parameterType="String" resultType="hashmap">
    	SELECT 		M.*
					, UI_ID NAME
					, CASE UIA_DIVISION
						WHEN 'A' THEN S.UIA_KEYNO
						WHEN 'U' THEN (
							SELECT	UIA_KEYNO
							FROM	U_USERINFO_AUTHORITY 
							WHERE	UIA_KEYNO = S.UIA_MAINKEY
						)
						ELSE ''
					END UIA_MAINKEY
					, S.UIA_KEYNO
					, UIA_NAME
					, UIA_DIVISION
		FROM   		U_USERINFO M
		LEFT JOIN  	U_USERINFO_MEMBER_AUTHORITY U
		ON 			M.UI_KEYNO = U.UI_KEYNO
		LEFT JOIN 	U_USERINFO_AUTHORITY S
		ON 			U.UIA_KEYNO = S.UIA_KEYNO    	
    	WHERE  		UI_ID = #{UI_ID}
    </select>
  	
  	<!-- 로그인 사용자 정보 -->
     <select id="selectUserInfo" parameterType="String" resultType="USER">
        <![CDATA[
			SELECT		S.UIA_NAME
						, S.UIA_KEYNO
						, M.*
						,  TO_CHAR(M.UI_LOCKDATE, 'YYYY-MM-DD HH24:MI:SS') lockDate
			FROM		U_USERINFO M
			LEFT JOIN  	U_USERINFO_MEMBER_AUTHORITY U
			ON 			M.UI_KEYNO = U.UI_KEYNO
			LEFT JOIN 	U_USERINFO_AUTHORITY S
			ON 			U.UIA_KEYNO = S.UIA_KEYNO
			WHERE 		UI_ID = #{UI_ID} 
        ]]>
    </select>
  	
  	
  	
    
    
    <sql id="UI_getListBody">
		FROM (
			SELECT	AB.*
					, ROW_NUMBER() OVER (
		    		<choose>
				 		<when test="orderBy == 1">
				 		ORDER BY	COUNT ${sortDirect}
				 		</when>
				 		<when test="orderBy == 2">
				 		ORDER BY	UI_ID ${sortDirect}
				 		</when>
				 		<when test="orderBy == 3">
				 		ORDER BY	UI_NAME ${sortDirect}
				 		</when>
				 		<when test="orderBy == 4">
				 		ORDER BY	UIA_NAME ${sortDirect}
				 		</when>
				 		<when test="orderBy == 5">
				 		ORDER BY	UI_REGDT ${sortDirect}
				 		</when>
				 		<when test="orderBy == 6">
				 		ORDER BY	UI_LASTLOGIN ${sortDirect}
				 		</when>
				 		<when test="orderBy == 7">
				 		ORDER BY	AUTH ${sortDirect}
				 		</when>
				 		<otherwise>
				 		ORDER BY 	COUNT DESC
				 		</otherwise>
			 		</choose>
			 		) RNUM
			FROM (
				SELECT 	ROWNUM AS COUNT
						, B.* 
				FROM (
					SELECT	( 
								SELECT 		LISTAGG(B.UIA_NAME,',')  WITHIN GROUP (ORDER BY A.UI_KEYNO)
				             	FROM 		U_USERINFO_MEMBER_AUTHORITY A
				             	LEFT JOIN 	U_USERINFO_AUTHORITY B
				             	ON 			A.UIA_KEYNO = B.UIA_KEYNO
				             	WHERE 		UI_KEYNO = M.UI_KEYNO
				          	) AS UIA_NAME
				          	, M.UI_KEYNO
							, M.UI_ID
							, UI_NAME
				    		, UI_EMAIL
				    		, UI_PHONE
				    		, TO_CHAR(M.UI_LASTLOGIN,'YYYY-MM-dd HH24:mi:ss') AS UI_LASTLOGIN
				    		, TO_CHAR(M.UI_REGDT,'YYYY-MM-dd HH24:mi:ss') AS UI_REGDT
				    		, CASE WHEN M.UI_AUTH_YN = 'Y' THEN 'O' ELSE 'X' END AS UI_AUTH_YN
				    		<![CDATA[
				    		, CASE 
				    			WHEN M.UI_AUTH_YN = 'Y' THEN 'O' 
				    			ELSE 'X'
				    		END AUTH
				    		]]>
				    		, ROW_NUMBER() OVER(PARTITION BY M.UI_KEYNO ORDER BY 1) AS GROUP_TEMP
					FROM 	U_USERINFO M
		         	WHERE UI_DELYN = 'N'
					ORDER BY UI_REGDT
				) B
				WHERE GROUP_TEMP = 1
			) AB
		WHERE 1=1
		<if test="authority != null">
		AND		UIA_NAME IS NOT NULL
		</if>
		<if test="searchList != null">
	 	<foreach collection="searchList" item="item">
	 		<choose>
	 			<when test='item.searchIndex.equals("1")'>
 		AND		COUNT 				LIKE '%' || #{item.searchKeyword} || '%'					
	 			</when>
	 			<when test='item.searchIndex.equals("2")'>
 		AND		UI_ID				LIKE '%' || #{item.searchKeyword} || '%'					
	 			</when>
	 			<when test='item.searchIndex.equals("3")'>
 		AND		UI_NAME 			LIKE '%' || #{item.searchKeyword} || '%'					
	 			</when>
	 			<when test='item.searchIndex.equals("4")'>
 		AND		UIA_NAME			LIKE '%' || #{item.searchKeyword} || '%'					
	 			</when>
	 			<when test='item.searchIndex.equals("5")'>
 		AND		UI_REGDT 			LIKE '%' || #{item.searchKeyword} || '%'						
	 			</when>
	 			<when test='item.searchIndex.equals("6")'>
 		AND		UI_LASTLOGIN 		LIKE '%' || #{item.searchKeyword} || '%'						
	 			</when>
	 			<when test='item.searchIndex.equals("7")'>
 		AND		AUTH 				LIKE '%' || #{item.searchKeyword} || '%'						
	 			</when>
	 			<when test='item.searchIndex.equals("all")'>
 		AND (
 				COUNT 				LIKE '%' || #{item.searchKeyword} || '%' 	OR
 				UI_ID				LIKE '%' || #{item.searchKeyword} || '%' 	OR
 				UI_NAME 			LIKE '%' || #{item.searchKeyword} || '%' 	OR
 				UIA_NAME			LIKE '%' || #{item.searchKeyword} || '%' 	OR
 				UI_REGDT 			LIKE '%' || #{item.searchKeyword} || '%' 	OR
 				UI_LASTLOGIN 		LIKE '%' || #{item.searchKeyword} || '%' 	OR
 				AUTH 				LIKE '%' || #{item.searchKeyword} || '%' 	
 		)							
	 			</when>
			 	<when test='item.searchIndex.equals("authority")'>
 		AND (
 				UI_ID				LIKE '%' || #{item.searchKeyword} || '%' 	OR
 				UI_NAME 			LIKE '%' || #{item.searchKeyword} || '%'
 		)							
	 			</when>
	 		</choose>
	 	</foreach>
	 	</if>
		)AA
	
	</sql>
  	
    <select id="UI_getListCnt" resultType="int">
		SELECT	COUNT(*)
		<include  refid="UI_getListBody"/>
    </select>
    
    <select id="UI_getList" resultType="hashmap">
    	SELECT	* 
		<include  refid="UI_getListBody"/>
		<if test=" recordCountPerPage != 0">
		WHERE 1=1
		AND 	RNUM BETWEEN  #{firstIndex}+1 AND #{lastIndex} 
		</if>  
    </select>
    
    
  	
  	
  	<!-- 회원 목록 -->
	<select id="UI_select" parameterType="USER" resultType="USER">
		SELECT  	S.UIA_KEYNO
					, S.UIA_DIVISION
					, S.UIA_NAME
					, M.*
		 FROM 		U_USERINFO M
         LEFT JOIN 	U_USERINFO_MEMBER_AUTHORITY A
         ON			M.UI_KEYNO 	= A.UI_KEYNO
         LEFT JOIN 	U_USERINFO_AUTHORITY S
         ON			A.UIA_KEYNO	=	S.UIA_KEYNO
		 WHERE 		UI_DELYN	=	'N'
		 AND	 	UI_ID		=	#{UI_ID}
    </select>
  	 
	<!-- 회원 등록 -->
	<insert id="UI_insert" parameterType="USER">
       	INSERT INTO U_USERINFO
		(
				  UI_KEYNO
				, UI_ID
				, UI_PASSWORD
				, UI_NAME
				, UI_EMAIL
				, UI_PHONE
				, UI_BIRTH
				, UI_ZENDER
				, UI_REGDT
				, UI_AUTH_YN
				, UI_REP_NAME
				, UI_PASSWORD_CHDT
		)
		VALUES
		(
				  #{UI_KEYNO}
				, #{UI_ID}
				, #{UI_PASSWORD}
				, #{UI_NAME}
				, #{UI_EMAIL}
				, #{UI_PHONE}
				, #{UI_BIRTH}
				, #{UI_ZENDER}
				, SYSDATE
				, #{UI_AUTH_YN}
				, #{UI_REP_NAME}
				, SYSDATE
		)
    </insert>
    
    <update id="UI_updateUser" parameterType="USER">
    
    	UPDATE U_USERINFO
    	SET		  UI_NAME		=	#{UI_NAME}
 	   <if test='UI_EMAIL != null and UI_EMAIL != ""'>
    	         ,UI_EMAIL	    =	#{UI_EMAIL}
 	   </if>
    	         ,UI_PHONE	    =	#{UI_PHONE}
    	         ,UI_BIRTH	    =	#{UI_BIRTH}
    	         ,UI_ZENDER	    =	#{UI_ZENDER}
    	         ,UI_AUTH_YN	=	#{UI_AUTH_YN}
    	         ,UI_REP_NAME	=	#{UI_REP_NAME}
    	<if test='UI_PASSWORD != null and UI_PASSWORD != ""'>
    			, UI_PASSWORD	=	#{UI_PASSWORD}
    			, UI_PWD_INIT	=	'N'	
    	</if>		
    	<if test='UI_DORMANCY != null and UI_DORMANCY != ""'>
		    	, UI_DORMANCY	=	#{UI_DORMANCY}
    	</if>
    	WHERE	  UI_KEYNO		=	#{UI_KEYNO}
    </update>
    
    <update id="UI_passwordUpdate" parameterType="USER">
    	UPDATE	U_USERINFO
    	SET		  UI_PASSWORD	=	#{UI_PASSWORD}
    			, UI_PWD_INIT	=	'N'	
    			, UI_PASSWORD_CHDT = SYSDATE
    	WHERE	UI_KEYNO		=	#{UI_KEYNO}
    </update>
    
    <update id="UI_passwordAfterUpdate" parameterType="HashMap">
    	UPDATE	U_USERINFO
    	SET		UI_PASSWORD_CHDT = SYSDATE + #{REVISE_DATE}
    	WHERE	UI_KEYNO		=	#{UI_KEYNO}
    </update>
    
    <update id="UI_deleteL" parameterType="USER">
        UPDATE U_USERINFO 
        SET    UI_DELYN='Y'
        WHERE  UI_KEYNO=#{UI_KEYNO}  
    </update>
    
    <delete id="UI_deleteP" parameterType="USER">
        DELETE FROM U_USERINFO 
        WHERE  UI_KEYNO=#{UI_KEYNO}  
    </delete>
    
    <insert id="UW_insert" parameterType="USER">
    	INSERT INTO U_USERINFO_WITHDRAW
		(
				  UW_KEYNO
				<if test="UW_ZENDER != null and UW_ZENDER != '' and UW_ZENDER != 'null'">
				, UW_ZENDER
				</if>
				, UW_REGDT
				, UW_DEL_REASON
		)
		VALUES
		(
				  #{UW_KEYNO}
				<if test="UW_ZENDER != null and UW_ZENDER != '' and UW_ZENDER != 'null'">
				, #{UW_ZENDER}
				</if>
				, SYSDATE
				, #{UW_DEL_REASON}
		)
    </insert>

	<!-- 권한 삭제 -->
	<delete id="UI_deleteAuthority" parameterType="hashmap">
		DELETE FROM U_USERINFO_MEMBER_AUTHORITY
		WHERE	UI_KEYNO	=	#{UI_KEYNO}
	</delete>
	
	<!-- 권한 추가 -->
	<insert id="UI_setAuthority" parameterType="hashmap">
		INSERT ALL
		<foreach collection="UIA_KEYNO" item="item">
		INTO U_USERINFO_MEMBER_AUTHORITY
		(
			  UI_KEYNO
			, UIA_KEYNO 
		)
		VALUES
            (#{UI_KEYNO}, #{item})
        </foreach>
        SELECT * FROM DUAL
	</insert>     
	
	<!-- Email 로 임시 비밀 번호 발송 서버 비밀번호 변경 -->
	<update id="UI_updateUserTempPwd" parameterType="USER">
    	UPDATE U_USERINFO
    	SET		  UI_PASSWORD	=	#{UI_PASSWORD}	
    	WHERE	  UI_KEYNO		=	#{UI_KEYNO}
    </update>
    
    <update id="UI_updateUserInitPwd">
    	UPDATE 	U_USERINFO
    	SET		UI_PASSWORD		=	#{UI_PASSWORD}
    		  , UI_PWD_INIT		=	'N'	
    	WHERE	UI_KEYNO		=	#{UI_KEYNO}
    </update>
    
    <!-- 회원관리 설정 리스트 -->
    <select id="US_getList" resultMap="USERSETTING_MAP">
    
    	SELECT 		*
    	FROM		S_HOME_MANAGER H
    	LEFT JOIN	U_USERINFO_SETTING U
    	ON			H.HM_KEYNO	=	U.US_TYPE
    	LEFT JOIN	S_MENU_MANAGER M
    	ON			H.HM_MN_HOMEDIV_C = M.MN_KEYNO
    	WHERE		HM_USE_YN	=	'Y'
    	ORDER BY 	HM_KEYNO
    </select>
    
    
    <!-- 회원관리 설정 DATA -->
    <select id="US_getData" resultType="USERSETTING" parameterType="String">
    
    	SELECT 		U.*
    	FROM		S_HOME_MANAGER H
    	LEFT JOIN	U_USERINFO_SETTING U
    	ON			H.HM_KEYNO	=	U.US_TYPE
    	WHERE		H.HM_TILES	=	#{HM_TILES} AND HM_USE_YN = 'Y'
    </select>
   
    <!-- 회원관리 설정 DATA + 비밀번호 정규식 -->
    <select id="US_getData2" resultType="HashMap">
    	SELECT A.*, CS.SC_CODENM, CS.SC_CODEVAL01
		FROM (
		    	SELECT 		NVL2(U.US_REGEX, U.US_REGEX,(SELECT PASSWORD_REGEX FROM S_SITE_MANAGER WHERE H.HM_MN_HOMEDIV_C = HOMEPAGE_REP AND USERID	= #{USERID})) PASSWORD_REGEX		
							, U.*
		    	FROM		S_HOME_MANAGER H
		    	LEFT JOIN	U_USERINFO_SETTING U
		    	ON			H.HM_KEYNO	=	U.US_TYPE
		    	WHERE		H.HM_TILES	=	#{HM_TILES} AND HM_USE_YN = 'Y'
	    	) A
		LEFT JOIN S_COMMON_CODE_SUB CS
		ON A.PASSWORD_REGEX = CS.SC_KEYNO
    </select>
    
    
    <!-- 회원관리 설정 저장 -->
    <insert id="US_insertData" parameterType="USERSETTING">
        MERGE INTO U_USERINFO_SETTING MAIN 
			USING  
		    (SELECT   #{US_TYPE} AS US_TYPE 
		    		, #{US_UIA_KEYNO} AS US_UIA_KEYNO 
		            , #{US_AUTH} AS US_AUTH 
		            , #{US_REGEX} AS US_REGEX 
		            , #{US_ID_FILTER} AS US_ID_FILTER 
		            , #{US_INFO1} AS US_INFO1
		            , #{US_INFO2} AS US_INFO2
		      FROM DUAL 
		    ) TEMP 
		  ON (MAIN.US_TYPE = TEMP.US_TYPE) 
		WHEN MATCHED THEN 
		       UPDATE 
		              SET 
		                US_UIA_KEYNO	=	#{US_UIA_KEYNO}
		              , US_AUTH			=	#{US_AUTH}
		              , US_REGEX		=	#{US_REGEX}
		              , US_ID_FILTER	=	#{US_ID_FILTER}
		              , US_INFO1		=	#{US_INFO1}
		              , US_INFO2		=	#{US_INFO2} 
		WHEN NOT MATCHED THEN 
		       INSERT 
		              ( 
		                  US_TYPE
		                , US_UIA_KEYNO
		                , US_AUTH
		                , US_REGEX
		                , US_ID_FILTER
		                , US_INFO1
		                , US_INFO2
		              ) 
		              VALUES 
		              ( 
		                  #{US_TYPE}
		                , #{US_UIA_KEYNO}
		                , #{US_AUTH}
		                , #{US_REGEX}
		                , #{US_ID_FILTER}
		                , #{US_INFO1}
		                , #{US_INFO2}
		              )
    </insert>
    
    
   	<select id="UI_findUserWithEmail" resultType="USER" parameterType="String">
    	SELECT 	* 
    	FROM 	U_USERINFO
    	WHERE	UI_NAME		=	#{UI_NAME}
    	AND		UI_EMAIL	=	#{UI_EMAIL}
    	AND		UI_DELYN	=	'N' 
    </select>
    
    <select id="UI_findUserIDWithEmail" resultType="USER" parameterType="String">
    	SELECT 	* 
    	FROM 	U_USERINFO
    	WHERE	UI_ID		=	#{UI_ID}
    	AND		UI_EMAIL	=	#{UI_EMAIL}
    	AND		UI_DELYN	=	'N' 
    </select>
    
    
    <!-- 아이디와 이메일 중복 체크 -->
    <select id="UI_checkIdAndEmail" resultType="String" parameterType="USER">
    	SELECT	LISTAGG(result,',')  WITHIN GROUP (ORDER BY OD) 
		FROM (
					SELECT 	'email' result, 1 AS OD            
					FROM 	U_USERINFO
					WHERE	UI_EMAIL	=	#{UI_EMAIL}
					
					UNION
					
					SELECT 	'id', 2 AS OD
					FROM 	U_USERINFO
					WHERE	UI_ID	=	#{UI_ID}
				)
    	
    </select>
    
     <!-- 아이디 중복 체크 -->
    <select id="UI_checkId" resultType="int" parameterType="USER">
			SELECT 	COUNT(*) 
			FROM 	U_USERINFO
			WHERE	UI_ID	=	#{UI_ID}
    </select>
    
    <!-- 유저 인증 -->
    <update id="UI_userSignAuth" parameterType="USER">
    	UPDATE U_USERINFO
    	SET		  UI_AUTH_YN		=	'Y'
    	WHERE	  UI_ID		=	#{UI_ID}
    </update>
    
    <!-- 유저 인증데이터 저장 -->
    <update id="UI_userSignAuthData" parameterType="USER">
    	UPDATE U_USERINFO
    	SET		  UI_AUTH_DATA		=	#{UI_AUTH_DATA}
    	WHERE	  UI_KEYNO			=	#{UI_KEYNO}
    </update>
    
    <!-- 유저 인증 확인-->
    <select id="UI_userSignAuthConfirm" parameterType="String" resultType="USER">
    	SELECT	*
    	FROM	U_USERINFO
    	WHERE 	UI_AUTH_DATA		=	#{UI_AUTH_DATA}
    </select>
    
    
 
    <update id="UI_updateLastLogin">
    -- LOG OFF
    	UPDATE 	  U_USERINFO
    	SET		  UI_LASTLOGIN		=	SYSDATE
    			, UI_LOGIN_COUNT	=	UI_LOGIN_COUNT + 1
    	WHERE	  UI_ID				=	#{UI_ID}
    </update>
    
     <!-- 잠금 해제 -->
    <update id="updateUnlock" parameterType="USER">
	    UPDATE U_USERINFO
	    SET		UI_LOCKYN = 'N',
	    		UI_TRY_COUNT = 0,
	    		UI_LOCKDATE = NULL
	    WHERE	UI_KEYNO = #{UI_KEYNO}
    </update>
    
    <!-- 잠금 카운트 갱신  -->
    <update id="updateLock" parameterType="USER">
	    UPDATE U_USERINFO
	    SET		UI_LOCKYN = 'Y',
	    		UI_TRY_COUNT = #{UI_TRY_COUNT},
	    		UI_LOCKDATE = SYSDATE
	    WHERE	UI_KEYNO = #{UI_KEYNO}
    </update>
    
    <update id="updateTryCount" parameterType="USER">
	    UPDATE U_USERINFO
	    SET		UI_TRY_COUNT	= 	#{UI_TRY_COUNT}
	    WHERE	UI_KEYNO = #{UI_KEYNO}
    </update>
    
    <!-- 회원 탈퇴 목록 조회 -->
    <select id="UW_getList" resultType="USER" resultMap="ResultMap.rownumHashMap">
    	SELECT ROWNUM AS COUNT, TO_CHAR(UW_REGDT,'YYYY-MM-dd HH24:mi:ss') UW_REGDT, SC.SC_CODENM UW_DEL_REASON, NVL(UW_ZENDER, ' ') UW_ZENDER
    	FROM U_USERINFO_WITHDRAW UW
    	LEFT JOIN S_COMMON_CODE_SUB SC
    	ON UW.UW_DEL_REASON = SC.SC_KEYNO
    </select>
    
    <!-- 비밀번호 변경 주기 확인 -->
    <select id="vertifyPWCycle" parameterType="HashMap" resultType="HashMap">
	    <![CDATA[
	    	SELECT UI_KEYNO, UI_REGDT, UI_PASSWORD_CHDT
				, SYSDATE - #{PASSWORD_CYCLE} AS CYCLE_DT
				, CASE 
					  WHEN UI_PASSWORD_CHDT < (SYSDATE - #{PASSWORD_CYCLE}) THEN 1
					  ELSE 0
				  END AS CK
			FROM U_USERINFO
			WHERE UI_KEYNO = #{UI_KEYNO}
		]]>
    </select>
    
     <!-- 비밀번호 정규식 확인 -->
    <select id="get_PasswordRegex" resultType="String">
    	SELECT SC.SC_CODEVAL01 PASSWORD_REGEX
		FROM(
		SELECT  NVL(NULLIF(US.US_REGEX,'')
				,(SELECT PASSWORD_REGEX FROM S_SITE_MANAGER WHERE HM.HM_MN_HOMEDIV_C = HOMEPAGE_REP AND USERID	= #{USERID})
				) PASSWORD_REGEX
		FROM U_USERINFO_SETTING US 
		LEFT JOIN S_HOME_MANAGER HM
		ON US.US_TYPE = HM.HM_KEYNO
		WHERE HM.HM_TILES = #{HM_TILES}
		AND   HM.HM_USE_YN = 'Y'
		) AA
		LEFT JOIN S_COMMON_CODE_SUB SC
		ON AA.PASSWORD_REGEX = SC.SC_KEYNO
    </select>
    
    <!-- sns 가입자 조회(sns_id, sns_type으로 확인) -->
    <select id="getSnsMember" parameterType="HashMap" resultType="USER">
    	SELECT		S.UIA_NAME
					, S.UIA_KEYNO
					, M.*
		FROM		U_USERINFO M
		LEFT JOIN  	U_USERINFO_MEMBER_AUTHORITY U
		ON 			M.UI_KEYNO = U.UI_KEYNO
		LEFT JOIN 	U_USERINFO_AUTHORITY S
		ON 			U.UIA_KEYNO = S.UIA_KEYNO
		WHERE 		UI_SNS_ID = #{uniqId}
    	AND			UI_SNS_TYPE = #{type}
    </select>
    
    <!-- SNS 회원 등록 -->
	<insert id="UI_snsInsert" parameterType="USER">
       	INSERT INTO U_USERINFO
		(
				  UI_KEYNO
				, UI_ID
				, UI_NAME
				, UI_REP_NAME
				, UI_EMAIL
				, UI_REGDT
				, UI_SNS_ID
				, UI_SNS_TYPE
				, UI_AUTH_YN
		)
		VALUES
		(
				  #{UI_KEYNO}
				, #{UI_ID}
				, #{UI_NAME}
				, #{UI_REP_NAME}
				, #{UI_EMAIL}
				, SYSDATE
				, #{UI_SNS_ID}
				, #{UI_SNS_TYPE}
				, #{UI_AUTH_YN}
		)
    </insert>
    
    <update id="UI_updateDormancyYN" parameterType="HashMap">
     <![CDATA[
		UPDATE 		U_USERINFO 
		SET 		UI_DORMANCY		=	#{UI_DORMANCY}
		WHERE		UI_LASTLOGIN 	IS NOT NULL	
		AND 		UI_LASTLOGIN 	<	 SYSDATE - (INTERVAL '2' YEAR)
	 ]]>
	 </update>
	 
	 <!-- 유저 휴면해제 -->
    <update id="UI_userDormancy" parameterType="USER">
        UPDATE U_USERINFO
        SET          UI_DORMANCY    =    'N'
        WHERE      UI_ID        =    #{UI_ID}
    </update>
</mapper>
 